@using CMS.Models
@model IEnumerable<NavigationMenu>

@{
    var config = ViewData["SidebarConfig"] as SidebarItem;
    var currentPath = Context.Request.Path.Value?.ToLower() ?? "";

    // Đã ẩn cái biến title đi cho code sạch sẽ vì không dùng đến nữa
}

<div class="shadow-sm rounded mb-4 bg-white">
    @if (Model != null && Model.Any())
    {
        <div class="list-group sidebar-menu">
            @foreach (var item in Model)
            {
                string itemUrl = item.Url;

                if (itemUrl == "#" && item.ContentPageId.HasValue && item.LinkedPage != null)
                {
                    itemUrl = $"/bai-viet/{item.LinkedPage.Id}/{item.LinkedPage.Slug}";
                }

                if (!string.IsNullOrEmpty(itemUrl) && itemUrl != "#")
                {
                    itemUrl = ("/" + itemUrl).Replace("//", "/");
                }

                string activeClass = (itemUrl != "#" && currentPath == itemUrl.ToLower()) ? "active" : "";

                <a href="@itemUrl" class="list-group-item list-group-item-action @activeClass">
                    @item.Name
                </a>
            }
        </div>
    }

    @if (config != null && !string.IsNullOrEmpty(config.Content))
    {
        <div class="p-3 fs-6 text-muted border-top">
            @Html.Raw(config.Content)
        </div>
    }
</div>