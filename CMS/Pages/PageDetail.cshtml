@page "/bai-viet/{id:int}/{slug?}"
@model CMS.Pages.PageDetailModel
@{
    ViewData["Title"] = Model.ContentPage.Title;

    // --- LOGIC: Kiểm tra bật tắt Sidebar ---
    bool showSidebar = Model.ContentPage.HasSidebar;

    // Tính toán class: Có Sidebar thì chiếm 9 phần bên phải, không có thì Full
    string contentClass = showSidebar ? "col-lg-9" : "col-12";
}

<style>
    /* =========================================================
           CSS CHUẨN PHONG CÁCH HUST (BÁCH KHOA)
        ========================================================= */
    body {
        background-color: #ffffff !important;
    }
    /* Nền trắng bóc */

    .page-container {
        padding: 30px 0 60px 0;
        min-height: 100vh;
    }

    /* 1. Thanh điều hướng Breadcrumb */
    .hust-breadcrumb {
        font-family: Arial, sans-serif;
        font-size: 15px;
        font-weight: 700;
        text-transform: uppercase;
        margin-bottom: 25px;
        letter-spacing: 0.5px;
    }

        .hust-breadcrumb a {
            color: #B3000F;
            text-decoration: none;
        }

            .hust-breadcrumb a:hover {
                text-decoration: none !important; /* 🔥 Đã xóa gạch chân */
                opacity: 0.8; /* Thêm hiệu ứng mờ nhẹ đi một chút cho có cảm giác bấm */
            }

        .hust-breadcrumb .separator {
            margin: 0 10px;
            color: #B3000F;
            font-weight: normal;
        }

    /* 2. Tiêu đề bài viết */
    .article-title {
        font-family: Arial, sans-serif;
        font-size: 26px;
        font-weight: bold;
        color: #333333;
        text-transform: uppercase; /* Ép chữ in hoa toàn bộ */
        margin-bottom: 15px;
        line-height: 1.4;
    }

    /* 3. Dòng thời gian & Công cụ (Meta) */
    .article-meta {
        font-family: Arial, sans-serif;
        font-size: 14px;
        color: #555555;
        border-bottom: 1px solid #e0e0e0;
        padding-bottom: 15px;
        margin-bottom: 25px;
    }

    .article-actions i {
        font-size: 18px;
        color: #777777;
        margin-left: 18px;
        cursor: pointer;
        transition: color 0.2s;
    }

        .article-actions i:hover {
            color: #B3000F;
        }

    /* 4. Nội dung bài viết (Giữ nguyên các thuộc tính xịn của bác) */
    .article-content {
        font-family: 'Times New Roman', serif;
        font-size: 20px;
        line-height: 1.7;
        color: #222222;
        text-align: justify;
    }

        .article-content img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 25px auto;
        }

        /* Bảng và Quote của bác giữ lại nguyên vẹn */
        .article-content .quote-classic {
            background: #f8f9fa;
            border-left: 5px solid #007bff;
            padding: 25px;
            margin: 30px 0;
            font-style: italic;
            color: #555;
        }

        .article-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 18px;
        }

            .article-content table th {
                background-color: #003366;
                color: white;
                text-align: left;
                padding: 12px 15px;
            }

            .article-content table td {
                border: 1px solid #dee2e6;
                padding: 12px 15px;
            }

            .article-content table tr:nth-child(even) {
                background-color: #f8f9fa;
            }
</style>

<div class="page-container">
    <div class="container">

        <div class="hust-breadcrumb">
            <a href="/" title="Về trang chủ">TRANG CHỦ</a>

            @if (!string.IsNullOrEmpty(Model.ContentPage.Category))
            {
                <span class="separator">›</span>
                <span style="color: #B3000F;" title="Chuyên mục hiện tại">
                    @Model.ContentPage.Category.ToUpper()
                </span>
            }
        </div>
        <div class="row">

            @if (showSidebar)
            {
                <div class="col-lg-3 mb-4 pe-lg-4">
                    <div class="sidebar-wrapper sticky-top" style="top: 20px; z-index: 10;">
                        @await Component.InvokeAsync("Sidebar", new { currentCategory = Model.ContentPage.Category })
                    </div>
                </div>
            }

            <div class="@contentClass">
                <article>
                    <h1 class="article-title">@Model.ContentPage.Title</h1>

                    <div class="article-meta d-flex justify-content-between align-items-center">
                        <span>
                            @{
                                // Code "độ" lại để hiển thị "Thứ mấy - ngày/tháng/năm giờ:phút"
                                var culture = new System.Globalization.CultureInfo("vi-VN");
                                string formattedDate = Model.ContentPage.CreatedAt.ToString("dddd - dd/MM/yyyy HH:mm", culture);
                                // Viết hoa chữ cái đầu (VD: thứ năm -> Thứ năm)
                                formattedDate = char.ToUpper(formattedDate[0]) + formattedDate.Substring(1);
                            }
                            @formattedDate
                        </span>

                        <div class="article-actions">
                            <i class="bi bi-envelope-fill" title="Gửi email"></i>
                            <i class="bi bi-printer-fill" title="In bài viết" onclick="window.print()"></i>
                            <i class="bi bi-floppy-fill" title="Lưu bài viết"></i>
                        </div>
                    </div>

                    <div class="article-content">
                        @Html.Raw(Model.ContentPage.Content)
                    </div>
                </article>
            </div>

        </div>
    </div>
</div>